-- PRODUCT TABLE
CREATE TABLE PRODUCT (
	PRODUCT_ID			BIGINT			    NOT NULL,
	NAME				VARCHAR(256)	    NOT NULL,
	PRICE           	NUMERIC			    NOT NULL,
	DATE_INSERTED		TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
	DATE_UPDATED		TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()
);

-- PRIMARY KEY
ALTER TABLE PRODUCT
ADD CONSTRAINT PRODUCT_PK
PRIMARY KEY (PRODUCT_ID);

-- PRODUCT SEQUENCE
CREATE SEQUENCE IF NOT EXISTS PRODUCT_ID_SEQ
INCREMENT BY 1
MINVALUE 1
START WITH 1
CACHE 1;

-- CATEGORY TABLE
CREATE TABLE CATEGORY (
	CATEGORY_ID			BIGINT			    NOT NULL,
	NAME				VARCHAR(256)	    NOT NULL,
	DESCRIPTION         VARCHAR(256),
	DATE_INSERTED		TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
	DATE_UPDATED		TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()
);

-- PRIMARY KEY
ALTER TABLE CATEGORY
ADD CONSTRAINT CATEGORY_PK
PRIMARY KEY (CATEGORY_ID);

-- CATEGORY SEQUENCE
CREATE SEQUENCE IF NOT EXISTS CATEGORY_ID_SEQ
INCREMENT BY 1
MINVALUE 1
START WITH 1
CACHE 1;

CREATE TABLE PRODUCT_CATEGORY_RELATION (
	PRODUCT_CATEGORY_RELATION_ID		    BIGINT			NOT NULL,
	PRODUCT_ID						        BIGINT			NOT NULL,
	CATEGORY_ID								BIGINT			NOT NULL,
	DATE_INSERTED		TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
	DATE_UPDATED		TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()
);

-- CATEGORY SEQUENCE
CREATE SEQUENCE IF NOT EXISTS PRODUCT_CATEGORY_RELATION_ID_SEQ
INCREMENT BY 1
MINVALUE 1
START WITH 1
CACHE 1;

-- PRIMARY KEY
ALTER TABLE PRODUCT_CATEGORY_RELATION
ADD CONSTRAINT PRODUCT_CATEGORY_RELATION_PK
PRIMARY KEY (PRODUCT_CATEGORY_RELATION_ID);

--FOREIGN KEYS
ALTER TABLE PRODUCT_CATEGORY_RELATION
ADD CONSTRAINT PRODUCT_ID_FK
FOREIGN KEY (PRODUCT_ID)
REFERENCES PRODUCT(PRODUCT_ID);

ALTER TABLE PRODUCT_CATEGORY_RELATION
ADD CONSTRAINT CATEGORY_ID_FK
FOREIGN KEY (CATEGORY_ID)
REFERENCES CATEGORY(CATEGORY_ID);

-- AUTOGENERATED INDEX FOR PRODUCT_CATEGORY_RELATION
ALTER TABLE PRODUCT_CATEGORY_RELATION
    ALTER COLUMN PRODUCT_CATEGORY_RELATION_ID
        SET DEFAULT NEXTVAL('PRODUCT_CATEGORY_RELATION_ID_SEQ');

-- AUTOGENERATED INDEX FOR PROFILE
ALTER TABLE PRODUCT
    ALTER COLUMN PRODUCT_ID
        SET DEFAULT NEXTVAL('PRODUCT_ID_SEQ');

-- AUTOGENERATED INDEX FOR ACCOUNT_SERVICE
ALTER TABLE CATEGORY
    ALTER COLUMN CATEGORY_ID
        SET DEFAULT NEXTVAL('CATEGORY_ID_SEQ');